<div class="profile-container">
<mat-form-field>
  <mat-label>User Type</mat-label>
  <mat-select [formControl]="accountType">
    <mat-option value="INTERNAL">Internal</mat-option>
    <mat-option value="EXTERNAL">External</mat-option>
  </mat-select>
</mat-form-field>

<h3>Field Mapping</h3>

<mat-table #table [dataSource]="fields.controls">
  <!-- Header Column -->
  <ng-container matColumnDef="header">
    <mat-header-cell *matHeaderCellDef> Header </mat-header-cell>
    <mat-cell *matCellDef="let field" [formGroup]="field" class="border-right">
      <input type="text" matInput formControlName="header"/>
    </mat-cell>
  </ng-container>  

  <!-- Default Column -->
  <ng-container matColumnDef="default">
      <mat-header-cell *matHeaderCellDef> Default </mat-header-cell>
      <mat-cell *matCellDef="let field" [formGroup]="field">
        <input type="text" matInput formControlName="default"/>
      </mat-cell>
    </ng-container>  

  <!-- Name Column -->
  <ng-container matColumnDef="name">
    <mat-header-cell *matHeaderCellDef> Name </mat-header-cell>
    <mat-cell *matCellDef="let field" [formGroup]="field">
      <mat-form-field floatLabel="never">
        <mat-select formControlName="fieldName" placeholder="Field Name">
          <mat-option value="primary_id">Primary ID</mat-option>
          <mat-option value="first_name">First Name</mat-option>
          <mat-option value="last_name">Last Name</mat-option>
          <mat-option value="contact_info.address[].line1">Address Line 1</mat-option>
          <mat-option value="contact_info.address[].line2">Address Line 2</mat-option>
          <mat-option value="contact_info.address[].city">City</mat-option>
          <mat-option value="contact_info.address[].state_province">State</mat-option>
          <mat-option value="contact_info.address[].postal_code">Postal Code</mat-option>
          <mat-option value="contact_info.address[].country.value">Country Code</mat-option>
          <mat-option value="contact_info.address[].address_type[].value">Address Type (home, work)</mat-option>
          <mat-option value="contact_info.email[].email_address">Email address</mat-option>
          <mat-option value="contact_info.email[].email_type[].value">Email address type (personal, work)</mat-option>
          <mat-option value="contact_info.phone[].phone_number">Phone Number</mat-option>
          <mat-option value="contact_info.phone[].phone_type[].value">Phone Type (home, office, mobile)</mat-option>
          <mat-option value="user_identifier[].id_type.value">Identifier Type</mat-option>
          <mat-option value="user_identifier[].value">Identifier Value</mat-option>
          <mat-option value="user_group.value">User Group</mat-option>
          <mat-option value="birth_date">Birth Date (yyyy-mm-dd)</mat-option>
          <mat-option value="expiry_date">Expiration Date (yyyy-mm-dd)</mat-option>
          <mat-option value="password">Password</mat-option>
          <mat-option value="force_password_change">Force password change (TRUE/FALSE)</mat-option>
        </mat-select>
      </mat-form-field>
    </mat-cell>
  </ng-container>  

  <!-- Actions Column -->
  <ng-container matColumnDef="actions">
    <mat-header-cell *matHeaderCellDef>  </mat-header-cell>
    <mat-cell  *matCellDef="let field;  let j = index;">
      <button type="button" (click)="removeField(j)" mat-icon-button aria-label="Delete field">
        <mat-icon>delete_outline</mat-icon>
      </button>
    </mat-cell>
  </ng-container>

  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
  <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>  
</mat-table>
<button type="button" (click)="addField()" mat-icon-button aria-label="Add field">
  <mat-icon>add_circle</mat-icon>
</button>

<div *ngIf="fields.invalid " class="alert alert-danger">
  <ul>
    <li *ngFor="let error of fields.errors">
      {{error}}
    </li>
  </ul>
</div>  
</div>